webpackJsonp([4],{"/VHd":function(e,t){},xq4q:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("BO1k"),s=a.n(r),n=a("Y8t/"),o=a("nSkA"),i={name:"TyIncome",data:function(){return{selectSearchMenu:"0",selectSearchType:"1",selectSearchHour:(new Date).getHours()-2,selectSearchPartner:"0",isPartner:!1,searchNowDate:Object(o.b)(Date.now()),tbodyHeight:0,proveName:"",showNowDate:"",showTwoNowDate:"",nums:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],tableTwoData:[],tableData:[],developerName:"",searchMenuType:""}},mounted:function(){var e=this;this.$nextTick(function(){var t=window.screen.height-345;e.tbodyHeight=t}),this.getProvIncome()},methods:{changes:function(){},getProvIncome:function(){var e=this;this.returnsearchMenuType();var t={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,developer_id:""};n.a.getProvIncome(t).then(function(t){"200"==t.code&&t.content.length>0?e.drawLine(t.content):e.$Message.warning("暂无数据")}).catch(function(e){})},drawLine:function(e){var t=this,a=this.$echarts.init(document.getElementById("myChart")),r={title:{text:"省份收入分析情况",textStyle:{fontSize:15,color:"#333",fontWeight:400},x:"center",subtext:"异常程度大于0为异常",subtextStyle:{fontSize:10,color:"#717b8d",fontWeight:400}},tooltip:{show:!0,formatter:function(e){if(void 0!=e.data)return e.name+"<br/>订单收入:"+e.data.showValue}},visualMap:{show:!0,type:"piecewise",splitNumber:2,pieces:[{min:0},{min:.5,max:e[0].ext_lvl}],left:"left",top:"top",range:["0",e[0].ext_lvl],calculable:!0,inRange:{color:["#eee","#d00000"]}},series:[{name:"",type:"map",map:"china",roam:!1,label:{show:!1},data:this.getProvParam(e)}]};a.clear(),a.setOption(r,!0),a.off("click"),a.on("click",function(e){e.value>=0?(t.getTableByChnl(e.data.prov_id),t.proveName=e.name):t.$Message.warning("数据小于异常范围")})},getTableByChnl:function(e){var t=this;this.showNowDate=Object(o.a)(this.searchNowDate);var a={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,prov_id:e};n.a.getChnlIncome(a).then(function(e){if("200"==e.code&&e.content.length>0){t.tableData=[];var a=!0,r=!1,n=void 0;try{for(var o,i=s()(e.content);!(a=(o=i.next()).done);a=!0){var l=o.value,c={partner:l.developer_name,grossIncome:l.ord_amt,developer_id:l.developer_id,extLvl:l.ext_lvl};t.tableData.push(c)}}catch(e){r=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}}else t.$Message.warning("暂无数据")}).catch(function(e){})},getProvParam:function(e){var t=[],a=!0,r=!1,n=void 0;try{for(var o,i=s()(e);!(a=(o=i.next()).done);a=!0){var l=o.value,c={name:l.prov_name,value:l.ext_lvl,prov_id:l.prov_id,showValue:l.ord_amt,prov_name:l.prov_name,extLvl:l.ext_lvl};t.push(c)}}catch(e){r=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}return this.proveName=t[0].prov_name,this.getTableByChnl(t[0].prov_id),t},getChnlIncome:function(){var e=this;this.returnsearchMenuType();var t="0"==this.selectSearchPartner?"":this.selectSearchPartner;this.showTwoNowDate=Object(o.a)(this.searchNowDate);var a={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,prov_id:"",is_imp:t};n.a.getChnlIncome(a).then(function(t){if("200"==t.code&&t.content.length>0){e.tableTwoData=[];var a=!0,r=!1,n=void 0;try{for(var o,i=s()(t.content);!(a=(o=i.next()).done);a=!0){var l=o.value,c={partner:l.developer_name,grossIncome:l.ord_amt,developer_id:l.developer_id,extLvl:l.ext_lvl};e.tableTwoData.push(c)}}catch(e){r=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}e.searchToprove(e.tableTwoData[0])}else e.$Message.warning("暂无数据")}).catch(function(e){})},searchToprove:function(e){var t=this;this.developerName=e.partner;var a={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,developer_id:e.developer_id};n.a.getProvIncome(a).then(function(e){"200"==e.code&&e.content.length>0?t.drawTwoLine(e.content):t.$Message.warning("暂无数据")}).catch(function(e){})},drawTwoLine:function(e){var t=this.$echarts.init(document.getElementById("myChartTwo")),a={title:{text:this.developerName+"各省收入分析情况",textStyle:{fontSize:15,color:"#333",fontWeight:400},x:"center",subtext:"异常程度大于0为异常",subtextStyle:{fontSize:10,color:"#717b8d",fontWeight:400}},tooltip:{show:!0,formatter:function(e){if(void 0!=e.data)return e.name+"<br/>订单收入:"+e.data.showValue}},visualMap:{show:!0,type:"piecewise",splitNumber:2,pieces:[{min:0},{min:.5,max:e[0].ext_lvl}],left:"left",top:"top",range:["0",e[0].ext_lvl],calculable:!0,inRange:{color:["#eee","#d00000"]}},series:[{name:"",type:"map",map:"china",roam:!1,label:{show:!1},data:this.getChnlParam(e)}]};t.clear(),t.setOption(a,!0)},getChnlParam:function(e){var t=[],a=!0,r=!1,n=void 0;try{for(var o,i=s()(e);!(a=(o=i.next()).done);a=!0){var l=o.value,c={name:l.prov_name,value:l.ext_lvl,prov_id:l.prov_id,showValue:l.ord_amt,prov_name:l.prov_name,extLvl:l.ext_lvl};t.push(c)}}catch(e){r=!0,n=e}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}return t},changeSearchType:function(){"1"==this.selectSearchType?(this.isPartner=!1,this.getProvIncome()):(this.isPartner=!0,this.getChnlIncome())},returnsearchMenuType:function(){switch(this.selectSearchMenu){case"0":this.searchMenuType="全部";break;case"1":this.searchMenuType="包月";break;case"4":this.searchMenuType="点播"}return this.searchMenuType}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[a("div",{staticClass:"ty_topInput"},[a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("业务类型：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchMenu,callback:function(t){e.selectSearchMenu=t},expression:"selectSearchMenu"}},[a("Option",{attrs:{value:"0"}},[e._v("全部")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("包月")]),e._v(" "),a("Option",{attrs:{value:"4"}},[e._v("点播")])],1)],1),e._v(" "),a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("查询方式：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchType,callback:function(t){e.selectSearchType=t},expression:"selectSearchType"}},[a("Option",{attrs:{value:"1"}},[e._v("省份")]),e._v(" "),a("Option",{attrs:{value:"2"}},[e._v("合作方")])],1)],1),e._v(" "),2==e.selectSearchType?a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("选择合作方：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchPartner,callback:function(t){e.selectSearchPartner=t},expression:"selectSearchPartner"}},[a("Option",{attrs:{value:"0"}},[e._v("全部合作方")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("重点合作方")])],1)],1):e._e(),e._v(" "),a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("日期：")]),e._v(" "),a("DatePicker",{staticClass:"cursorP",staticStyle:{width:"120px"},attrs:{type:"date",placeholder:"请选择日期"},model:{value:e.searchNowDate,callback:function(t){e.searchNowDate=t},expression:"searchNowDate"}})],1),e._v(" "),a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("小时：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchHour,callback:function(t){e.selectSearchHour=t},expression:"selectSearchHour"}},e._l(e.nums,function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t)+":00")])}))],1),e._v(" "),a("span",[a("Button",{attrs:{type:"primary",icon:"search"},on:{click:e.changeSearchType}},[e._v("搜索")])],1)]),e._v(" "),a("div",{staticClass:"clearBox ty_reportMain"},[a("div",{staticClass:"clearBox ty_mainDiv"},[a("div",{staticClass:"orderTopInfo"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isPartner,expression:"!isPartner"}],staticClass:"fl ty_mapReport ",attrs:{id:"myChart"}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isPartner,expression:"!isPartner"}],staticClass:"fr ty_tableReport"},[a("div",{staticClass:"ty_tableTitle"},[e._v(e._s(e.proveName)+"  "+e._s(e.showNowDate)+"  "+e._s(e.selectSearchHour)+":00 "+e._s(e.searchMenuType)+"业务 收入异常分析")]),e._v(" "),a("div",{staticClass:"ty_tableList"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:e.tbodyHeight,border:""}},[a("el-table-column",{attrs:{prop:"partner",label:"合作方"}}),e._v(" "),a("el-table-column",{attrs:{prop:"grossIncome",label:"总收入"}}),e._v(" "),a("el-table-column",{attrs:{prop:"extLvl",label:"异常程度"}})],1)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isPartner,expression:"isPartner"}],staticClass:"fr ty_mapReport myChartTwo",attrs:{id:"myChartTwo"}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isPartner,expression:"isPartner"}],staticClass:"fl ty_tableReport"},[a("div",{staticClass:"ty_tableTitle"},[e._v(" "+e._s(e.showTwoNowDate)+"  "+e._s(e.selectSearchHour)+":00 "+e._s(e.searchMenuType)+"业务 收入异常分析")]),e._v(" "),a("div",{staticClass:"ty_tableList"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableTwoData,height:e.tbodyHeight,border:""},on:{"row-click":e.searchToprove}},[a("el-table-column",{attrs:{prop:"partner",label:"合作方"}}),e._v(" "),a("el-table-column",{attrs:{prop:"grossIncome",label:"总收入"}}),e._v(" "),a("el-table-column",{attrs:{prop:"extLvl",label:"异常程度"}})],1)],1)])])])])])},staticRenderFns:[]};var c=a("VU/8")(i,l,!1,function(e){a("/VHd")},"data-v-84bdf314",null);t.default=c.exports}});