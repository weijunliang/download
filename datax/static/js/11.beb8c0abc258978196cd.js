webpackJsonp([11],{"1nJE":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("BO1k"),i=n.n(s),a=n("443r"),u=n("Y8t/"),o={name:"TyMenuMan",components:{deleteModal:a.a},data:function(){return{editBtnShow:!1,deleteShow:!1,deleteId:0,paddingL:"paddingL",paddingTL:"paddingTL",tbodyHeight:0,selectMenu:"-1/-1",menu:{menuId:"",menuName:"",gotoUrl:"",icon:""},tableData:[]}},mounted:function(){var e=this;this.$nextTick(function(){var t=window.screen.height-300;e.tbodyHeight=t}),this.getMenuList()},methods:{getMenuList:function(){var e=this;this.tableData=[];u.a.getMenuList({menu_name:""}).then(function(t){if("200"==t.code){var n=!0,s=!1,a=void 0;try{for(var u,o=i()(t.content);!(n=(u=o.next()).done);n=!0){var l=u.value,r={menuName:l.menu_name,num:l.menu_deep,gotoUrl:l.menu_url,id:l.menu_id,parentId:l.parent_id,icon:l.icon};e.tableData.push(r),e.pushMenu(l)}}catch(e){s=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(s)throw a}}}else e.$Message.error(t.message)}).catch(function(e){})},pushMenu:function(e){if(null!=e.childMenu){var t=!0,n=!1,s=void 0;try{for(var a,u=i()(e.childMenu);!(t=(a=u.next()).done);t=!0){var o=a.value,l={menuName:o.menu_name,num:o.menu_deep,gotoUrl:o.menu_url,id:o.menu_id,parentId:o.parent_id,icon:o.icon};this.tableData.push(l),null!=o.childMenu&&this.pushMenu(o)}}catch(e){n=!0,s=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw s}}}},addMenus:function(){var e=this;if("-1"!=this.selectMenu.split("/")[0])if(""!=this.menu.menuName)if(""!=this.menu.gotoUrl){var t=0;this.selectMenu.split("/")[1]>0&&(t=1);var n={menu_name:this.menu.menuName,parent_id:this.selectMenu.split("/")[0],menu_url:this.menu.gotoUrl,order_no:0,menu_deep:this.selectMenu.split("/")[1],icon:this.menu.icon,is_leaf_menu:t};u.a.addMenu(n).then(function(t){"200"==t.code?(e.getMenuList(),e.menu.menuName="",e.menu.gotoUrl="",e.menu.icon="",e.selectMenu="-1/-1",e.$Message.success("菜单添加成功")):e.$Message.error(t.message)}).catch(function(e){})}else this.$Message.error("请输入跳转路径！");else this.$Message.error("请输入菜单名称！");else this.$Message.error("请选择父级菜单！")},gotoPage:function(e){},editClick:function(e){console.log(e),this.editBtnShow=!0,this.selectMenu=e.parentId+"/"+e.num,this.menu.menuName=e.menuName,this.menu.gotoUrl=e.gotoUrl,this.menu.icon=e.icon,this.menu.menuId=e.id},cancelEdit:function(){this.editBtnShow=!1,this.menu.menuName="",this.menu.gotoUrl="",this.menu.icon="",this.selectMenu="-1/-1"},suerEdit:function(){var e=this;if("-1"!=this.selectMenu.split("/")[0])if(""!=this.menu.menuName)if(""!=this.menu.gotoUrl){var t=0;this.selectMenu.split("/")[1]>0&&(t=1);var n={menu_name:this.menu.menuName,parent_id:this.selectMenu.split("/")[0],menu_url:this.menu.gotoUrl,order_no:0,menu_deep:this.selectMenu.split("/")[1],is_leaf_menu:t,icon:this.menu.icon,menu_id:this.menu.menuId};u.a.updateMenu(n).then(function(t){"200"==t.code?(e.menu.menuName="",e.menu.gotoUrl="",e.menu.icon="",e.selectMenu="-1/-1",e.$Message.success("菜单修改成功"),setTimeout(function(){e.getMenuList(),e.editBtnShow=!1},1e3)):e.$Message.error(t.message)}).catch(function(t){e.$Message.error(t)})}else this.$Message.error("请输入跳转路径！");else this.$Message.error("请输入菜单名称！");else this.$Message.error("请选择父级菜单！")},deleteBtn:function(e){this.deleteShow=!0,this.deleteId=e.id},changeShowDel:function(e){this.deleteShow=e},sureDelete:function(e){var t=this,n={menu_id:e.id};u.a.deleteMenu(n).then(function(e){"200"==e.code?(t.$Message.success("删除成功!"),setTimeout(function(){t.getMenuList()},1e3)):t.$Message.error(e.message,1)}).catch(function(e){t.$Message.error(e.response.statusText,1)})}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("div",{staticClass:"ty_topInput"},[n("span",{staticClass:"ty_domList"},[n("Select",{staticStyle:{width:"200px"},model:{value:e.selectMenu,callback:function(t){e.selectMenu=t},expression:"selectMenu"}},[n("Option",{attrs:{value:"-1/-1"}},[e._v("请选择父级菜单")]),e._v(" "),n("Option",{attrs:{value:"0/1"}},[e._v("根目录")]),e._v(" "),e._l(e.tableData,function(t){return n("Option",{key:t.id,class:{paddingL:2==t.num,paddingTL:3==t.num},attrs:{value:t.id+"/"+(t.num+1)}},[e._v(e._s(t.menuName))])})],2)],1),e._v(" "),n("span",{staticClass:"ty_domList"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.menu.menuId,expression:"menu.menuId"}],attrs:{type:"hidden"},domProps:{value:e.menu.menuId},on:{input:function(t){t.target.composing||e.$set(e.menu,"menuId",t.target.value)}}}),e._v(" "),n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"菜单名称"},model:{value:e.menu.menuName,callback:function(t){e.$set(e.menu,"menuName",t)},expression:"menu.menuName"}})],1),e._v(" "),n("span",{staticClass:"ty_domList"},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"菜单跳转路径"},model:{value:e.menu.gotoUrl,callback:function(t){e.$set(e.menu,"gotoUrl",t)},expression:"menu.gotoUrl"}})],1),e._v(" "),n("span",{staticClass:"ty_domList"},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"菜单图标"},model:{value:e.menu.icon,callback:function(t){e.$set(e.menu,"icon",t)},expression:"menu.icon"}})],1),e._v(" "),n("span",{staticClass:"ty_domList",attrs:{span:"5"}},[n("Row",[e.editBtnShow?e._e():n("Button",{attrs:{type:"primary"},on:{click:e.addMenus}},[e._v("添加菜单")]),e._v(" "),e.editBtnShow?n("Button",{attrs:{type:"primary"},on:{click:e.suerEdit}},[e._v("修改")]):e._e(),e._v(" "),e.editBtnShow?n("Button",{attrs:{type:"default"},on:{click:e.cancelEdit}},[e._v("取消")]):e._e()],1)],1)]),e._v(" "),n("div",{staticClass:"ty_tableShowDiv"},[n("Row",[n("Col",{staticClass:"ty_table",attrs:{span:"24"}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:e.tbodyHeight,border:""}},[n("el-table-column",{attrs:{prop:"menuName",label:"菜单名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.num?n("i",{staticClass:"el-icon-minus marginL30"}):e._e(),e._v(" "),3==t.row.num?n("i",{staticClass:"el-icon-minus marginL60"}):e._e(),e._v(" "),n("span",[e._v(e._s(t.row.menuName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"gotoUrl",label:"跳转路径"}}),e._v(" "),n("el-table-column",{attrs:{prop:"icon",label:"图标名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"controler",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.editClick(t.row)}}},[e._v("编辑")]),e._v(" "),0!=t.row.parentId?n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){e.deleteBtn(t.row)}}},[e._v("删除")]):e._e()]}}])})],1)],1)],1)],1),e._v(" "),n("delete-modal",{attrs:{deleteId:e.deleteId,deleteShow:e.deleteShow},on:{deleteSure:e.sureDelete,changeShow:e.changeShowDel}})],1)},staticRenderFns:[]};var r=n("VU/8")(o,l,!1,function(e){n("K+rH")},null,null);t.default=r.exports},"K+rH":function(e,t){}});