webpackJsonp([5],{BJYg:function(e,t){},a8pT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("BO1k"),n=a.n(r),i=a("Y8t/"),o=a("nSkA"),s={name:"TyOrder",data:function(){return{selectSearchMenu:"0",selectSearchType:"1",selectSearchHour:(new Date).getHours()-2,selectSearchPartner:"0",searchNowDate:Object(o.b)(Date.now()),tbodyHeight:0,myChartObj:"省份流量激增",nums:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],tableData:[],developerName:"",provId:"",developerId:"",showNowDate:"",searchMenuType:"",getIndex:"0",lineTitleProveName:"",showVaiCriVal:""}},mounted:function(){var e=this;this.$nextTick(function(){var t=window.screen.height-345;e.tbodyHeight=t}),this.getChnlFlow()},methods:{changes:function(){},getChnlFlow:function(){var e=this;this.returnsearchMenuType(),this.showNowDate=Object(o.a)(this.searchNowDate);var t="0"==this.selectSearchPartner?"":this.selectSearchPartner,a={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,is_imp:t};i.a.getChnlFlow(a).then(function(t){"200"==t.code&&t.content.length>0?(e.tableData=[],t.content.forEach(function(t,a){var r={index:a,partner:t.developer_name,grossIncome:t.ord_cnt,developer_id:t.developer_id,orderCount:t.total_cnt,IncomeRate:(t.ord_cnt/t.total_cnt*100).toFixed(2)+"%",vaiCriVal:t.vai_cri_val};e.tableData.push(r)}),e.searchToprove(e.tableData[0])):e.$Message.warning("暂无数据")}).catch(function(e){})},searchToprove:function(e){var t=this;this.showVaiCriVal=e.vaiCriVal,this.developerName=e.partner,this.getIndex=e.index;var a={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,developer_id:e.developer_id};i.a.getProvFlow(a).then(function(a){"200"==a.code&&a.content.length>0?(t.drawTwoLine(a.content),t.developerId=e.developer_id,t.provId=a.content[0].prov_id,t.lineTitleProveName=a.content[0].prov_name,t.getTwoLineResource()):t.$Message.warning("暂无数据")}).catch(function(e){})},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.getIndex==t)return{"background-color":"#CAE1FF"}},drawTwoLine:function(e){var t=this,a=this.$echarts.init(document.getElementById("myChartTwo")),r={title:{text:this.developerName+"各省流量激增分析情况",textStyle:{fontSize:14,color:"#333",fontWeight:400},x:"center",subtext:"各省份请求总量大于有效阀值为异常",subtextStyle:{fontSize:10,color:"#717b8d",fontWeight:400}},tooltip:{show:!0,formatter:function(e){if(void 0!=e.data)return e.name+"<br/>请求总量:"+e.data.totleCnt+"<br/>有效阀值:"+e.data.vaiCriVal}},visualMap:{show:!0,type:"piecewise",splitNumber:2,pieces:[{min:0}],left:"left",top:"top",calculable:!0,inRange:{color:["#ffffff","#d00000"]}},series:[{name:"",type:"map",map:"china",roam:!1,label:{show:!1},data:this.getProvParam(e)}]};a.clear(),a.setOption(r,!0),a.off("click"),a.on("click",function(e){e.value>100?(t.provId=e.data.prov_id,t.lineTitleProveName=e.data.name,t.getTwoLineResource()):t.$Message.warning("数据小于异常范围")})},getProvParam:function(e){var t=[],a=!0,r=!1,i=void 0;try{for(var o,s=n()(e);!(a=(o=s.next()).done);a=!0){var c=o.value,l={name:c.prov_name,value:c.total_cnt-c.vai_cri_val,totleCnt:c.total_cnt,vaiCriVal:c.vai_cri_val,prov_id:c.prov_id};t.push(l)}}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return t},changeSearchType:function(){this.getChnlFlow()},getTwoLineResource:function(){var e=this,t={date_id:Object(o.a)(this.searchNowDate),hour_id:this.selectSearchHour,acct_mode:this.selectSearchMenu,developer_id:this.developerId,prov_id:this.provId};i.a.getChartFlow(t).then(function(t){if("200"==t.code&&t.content.length>0){var a=[],r=[],i=!0,o=!1,s=void 0;try{for(var c,l=n()(t.content);!(i=(c=l.next()).done);i=!0){var h=c.value;a.push(h.date_id),r.push(h.flowModelList)}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}e.creatLine(a,r)}else e.$Message.warning("暂无数据")}).catch(function(e){})},returnsearchMenuType:function(){switch(this.selectSearchMenu){case"0":this.searchMenuType="全部";break;case"1":this.searchMenuType="包月";break;case"4":this.searchMenuType="点播"}return this.searchMenuType},creatLine:function(e,t){var a=this.$echarts.init(document.getElementById("myChartLine")),r={title:{show:!0,text:"",subtext:this.developerName+" "+this.lineTitleProveName+" 流量激增",subtextStyle:{color:"#2c3e50"}},legend:{data:e,show:!0},tooltip:{trigger:"axis",formatter:function(e){var t=e[0].axisValue+"</br>",a=!0,r=!1,i=void 0;try{for(var o,s=n()(e);!(a=(o=s.next()).done);a=!0){var c=o.value;t+=c.seriesName+" 请求总量:"+c.value+"</br>"}}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return t}},xAxis:{type:"category",data:["0:00","1:00","2:00","3:00","4:00","5:00","6:00","7:00","8:00","9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],axisTick:{alignWithLabel:!0}},grid:{left:"1%",right:"2%",bottom:"5%",containLabel:!0},yAxis:{type:"value"},series:this.returnSeries(e,t,["#298ef5","#f5231b"])};a.setOption(r)},returnSeries:function(e,t,a){var r=[],i=[],o=!0,s=!1,c=void 0;try{for(var l,h=n()(t);!(o=(l=h.next()).done);o=!0){var v=l.value,u=!0,d=!1,p=void 0;try{for(var _,f=n()(v);!(u=(_=f.next()).done);u=!0){var y=_.value;e[0]==y.date_id?r.push(y.total_cnt):i.push(y.total_cnt)}}catch(e){d=!0,p=e}finally{try{!u&&f.return&&f.return()}finally{if(d)throw p}}}}catch(e){s=!0,c=e}finally{try{!o&&h.return&&h.return()}finally{if(s)throw c}}var w=[r,i],m=[];for(var b in e){var g={name:e[b],data:w[b],type:"line",itemStyle:{normal:{color:a[b],lineStyle:{color:a[b]}}}};m.push(g)}return m}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{height:"100%"}},[a("div",{staticClass:"ty_topInput"},[a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("业务类型：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchMenu,callback:function(t){e.selectSearchMenu=t},expression:"selectSearchMenu"}},[a("Option",{attrs:{value:"0"}},[e._v("全部")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("包月")]),e._v(" "),a("Option",{attrs:{value:"4"}},[e._v("点播")])],1)],1),e._v(" "),a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("选择合作方：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchPartner,callback:function(t){e.selectSearchPartner=t},expression:"selectSearchPartner"}},[a("Option",{attrs:{value:"0"}},[e._v("全部合作方")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("重点合作方")])],1)],1),e._v(" "),a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("日期：")]),e._v(" "),a("DatePicker",{staticClass:"cursorP",staticStyle:{width:"120px"},attrs:{type:"date",placeholder:"请选择日期"},model:{value:e.searchNowDate,callback:function(t){e.searchNowDate=t},expression:"searchNowDate"}})],1),e._v(" "),a("span",[a("span",{staticClass:"ty_serachSapn"},[e._v("小时：")]),e._v(" "),a("Select",{staticStyle:{width:"120px"},attrs:{filterable:""},model:{value:e.selectSearchHour,callback:function(t){e.selectSearchHour=t},expression:"selectSearchHour"}},e._l(e.nums,function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t)+":00")])}))],1),e._v(" "),a("span",[a("Button",{attrs:{type:"primary",icon:"search"},on:{click:e.changeSearchType}},[e._v("搜索")])],1)]),e._v(" "),a("div",{staticClass:"clearBox ty_reportMain"},[a("div",{staticClass:"clearBox ty_mainDiv"},[a("div",{staticClass:"orderTopInfo"},[a("div",{staticClass:"fr ty_mapReport myChartTwo",attrs:{id:"myChartTwo"}}),e._v(" "),a("div",{staticClass:"fl ty_tableReport"},[a("div",{staticClass:"ty_tableTitle"},[e._v(e._s(e.searchMenuType)+"业务  "+e._s("0"==this.selectSearchPartner?"全部合作方":"重点合作方")+" "+e._s(e.showNowDate)+" "+e._s(e.selectSearchHour)+":00流量激增异常分析")]),e._v(" "),a("div",{staticClass:"ty_tableList"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:e.tbodyHeight,border:"","row-style":e.selectedHighlight},on:{"row-click":e.searchToprove}},[a("el-table-column",{attrs:{prop:"partner",label:"合作方","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderCount",label:"请求总量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"grossIncome",label:"订单成功量",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"IncomeRate",label:"订单转化率",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vaiCriVal",label:"有效阀值(20%)"}})],1)],1)])]),e._v(" "),e._m(0)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"clearBox orderLine"},[t("div",{attrs:{id:"myChartLine"}})])}]};var l=a("VU/8")(s,c,!1,function(e){a("BJYg")},"data-v-80fd63f8",null);t.default=l.exports}});